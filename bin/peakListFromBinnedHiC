#!/usr/bin/env python

import argparse;
import kaic.network.HiCNetwork as net

def splitList(thisList):
    return thisList.split(",");

if __name__ == '__main__':
    parser = argparse.ArgumentParser();
    
    parser.add_argument(
        'input',
        help='''Binned Hi-C with bias vector'''
    );
    
    parser.add_argument(
        'genome',
        help='''Genome object'''
    );
    
    parser.add_argument(
        'output',
        help='''Output file'''
    );
    
    parser.add_argument(
        '-a', '--intra-fdr', dest='intra_fdr',
        type=float,
        default=None,
        help='''Intra-chromosomal contact FDR cutoff [0,1] or None (default)'''
    );
    
    parser.add_argument(
        '-e', '--inter-fdr', dest='inter_fdr',
        type=float,
        default=None,
        help='''Inter-chromosomal contact FDR cutoff [0,1] or None (default)'''
    );
    
    parser.add_argument(
        '-res', '--resolution', dest='resolution',
        type=int,
        help='''Cutoff for filtering very large fragments''',
        required=True
    );
    
    parser.add_argument(
        '-i', '--no-inter', dest='inter',
        action='store_false',
        help='''Do not calculate inter-chromosomal peaks'''
    );
    parser.set_defaults(inter=True);
    
    args = parser.parse_args()
    
    net.get_peaks_from_hic(args.input, args.genome, args.resolution, fdrIntra=args.intra_fdr, fdrInter=args.inter_fdr, findInterPeaks=args.inter, output=args.output)
    

    
