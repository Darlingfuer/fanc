#!/usr/bin/env python

import argparse
import os.path
from kaic.construct.seq import FragmentMappedReadPairs

import logging
logging.basicConfig(level=logging.DEBUG)

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    
    parser.add_argument(
        'input',
        help='''Input FragmentMappedPairs file'''
    )
    
    parser.add_argument(
        'output',
        nargs='?',
        help='''Output pdf'''
    )
    
    parser.add_argument(
        '-p', '--points', dest='points',
        type=int,
        help='''Data points that make up one increment of the x axis. More=smoother=less detail.'''
    )
    
    args = parser.parse_args()
    
    input_path = os.path.expanduser(args.input)
    output_path = None
    if args.output:
        output_path = os.path.expanduser(args.output)
    
    pairs = FragmentMappedReadPairs(file_name=input_path)
    pairs.plot_error_structure(output=output_path, data_points=args.points)
    pairs.close()
