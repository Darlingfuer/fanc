#!/usr/bin/env python

import argparse
import os.path

import logging
import kaic.plotting.plot_genomic_data as pgd
from kaic.data.genomic import Hic
logging.basicConfig(level=logging.DEBUG)

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    
    parser.add_argument(
        'input',
        help='''Input Hi-C file'''
    )
    
    parser.add_argument(
        '-r', '--region', dest='region',
        help='''Region selector string (e.g. "chr1:20456-330123")'''
    )
    
    parser.add_argument(
        '-l', '--lower', dest='lower',
        type=float,
        default=1.0,
        help='''Lower bound on Hi-C contact counts (for color scale, default: 1.0)'''
    )
    
    parser.add_argument(
        '-u', '--upper', dest='upper',
        type=float,
        default=40.0,
        help='''Upper bound on Hi-C contact counts (for color scale, default: 40.0)'''
    )
    
    parser.add_argument(
        '-o', '--output', dest='output',
        help='''Output file'''
    )
    
    args = parser.parse_args()
    
    input_path = os.path.expanduser(args.input)
    
    hic = Hic(input_path)
    
    output_path = None
    if args.output:
        output_path = os.path.expanduser(args.output)

    pgd.hic_matrix_plot(hic, output=output_path, key=args.region, zrange=[args.lower, args.upper])
    
    hic.close()
    