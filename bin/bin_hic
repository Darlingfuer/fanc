#!/usr/bin/env python

import argparse
import os.path
from kaic.data.genomic import Hic
import logging
logging.basicConfig(level=logging.DEBUG)

if __name__ == '__main__':
    parser = argparse.ArgumentParser()

    parser.add_argument(
        'hic',
        help='''Input Hic file'''
    )

    parser.add_argument(
        'output',
        help='''Output binned Hic object'''
    )

    parser.add_argument(
        'bin_size',
        type=int,
        help='''Bin size in base pairs'''
    )

    args = parser.parse_args()

    input_path = os.path.expanduser(args.hic)
    output_path = os.path.expanduser(args.output)

    hic = Hic(file_name=input_path, read_only=True)

    logging.info("Binning at %dbp" % args.bin_size)
    binned = hic.bin(args.bin_size, file_name=output_path)
    logging.info("Done.")

    hic.close()
    binned.close()
