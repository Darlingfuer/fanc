#!/usr/bin/env python

import argparse;
import kaic.correcting.knightMatrixBalancing as mb
import logging
logging.basicConfig(level=logging.DEBUG)

if __name__ == '__main__':
    parser = argparse.ArgumentParser();

    parser.add_argument(
        'input',
        help='''Input Hi-C Map file (high res binned data, hdf5 dict)'''
    );

    parser.add_argument(
        'genome',
        help='''Genome object file'''
    );
    
    parser.add_argument(
        'output',
        help='''Output file'''
    );

    parser.add_argument(
        '-res', '--resolution', dest='resolution',
        type=int,
        help='''Size of the genomic bins''',
        required=True
    );
    
    parser.add_argument(
        '-c', '--chromosome', dest='chromosome',
        action='store_true',
        help='''Correct intra-chromosomal maps only, and individually'''
    );
    parser.set_defaults(chromosome=False);
    
    args = parser.parse_args()
    mb.correct(args.input, args.genome, args.resolution, perChromosome=args.chromosome, output=args.output)
