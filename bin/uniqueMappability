#!/usr/bin/env python

import argparse
from kaic.mapping.mappability import unique_mappability

if __name__ == '__main__':
    parser = argparse.ArgumentParser();
    
    parser.add_argument(
        'genome',
        help='''Genome folder '''
    )
    
    parser.add_argument(
        'index',
        help='''Genome index '''
    )
    
    parser.add_argument(
        '-l', '--length', dest='length',
        type=int,
        help='''Read length''',
        required=True
    )
    
    parser.add_argument(
        '-s', '--offset', dest='offset',
        type=int,
        help='''Read offset''',
        required=True
    )
    
    parser.add_argument(
        '-c', '--chunks', dest='chunks',
        type=int,
        help='''Chunk size''',
        required=True
    )
    
    parser.add_argument(
        '-o', '--output', dest='output',
        help='''Output file''',
        required=True
    )
    
    args = parser.parse_args()
    
    mappable = unique_mappability(args.genome, args.index, args.length, args.offset, args.chunks)
    
    with open(args.output,'w') as o:
        o.write("chromosome\tstart\tend\n")
        for chromosome in mappable:
            for mappable_range in mappable[chromosome]:
                o.write("%s\t%d\t%d\n" % (chromosome, mappable_range[0], mappable_range[1]))

    