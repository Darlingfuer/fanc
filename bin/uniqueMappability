#!/usr/bin/env python

import argparse
from kaic.mapping.mappability import unique_mappability

if __name__ == '__main__':
    parser = argparse.ArgumentParser();
    
    parser.add_argument(
        'genome',
        help='''Genome folder '''
    )
    
    parser.add_argument(
        'index',
        help='''Genome index '''
    )
    
    parser.add_argument(
        '-l', '--length', dest='length',
        help='''Read length''',
        required=True
    )
    
    parser.add_argument(
        '-s', '--offset', dest='offset',
        type=int,
        help='''Read offset''',
        required=True
    )
    
    parser.add_argument(
        '-s', '--chunks', dest='chunks',
        type=int,
        help='''Chunk size''',
        required=True
    )
    
    parser.add_argument(
        '-o', '--output', dest='output',
        help='''Output file''',
        required=True
    )
    
    args = parser.parse_args()
    
    mappable = unique_mappability(args.genome, args.index, args.length, args.offset, args.chunks)
    
    with open(args.output) as o:
        for chromosome in mappable:
            o.write(chromosome + '\t')
            s = ''
            for ix in mappable[chromosome]:
                s += str(ix) + ','
            s = s[:-1]
            o.write(s + '\n')
    